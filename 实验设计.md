## CARM 实验设计



### 3. Results and analysis

**3.1 基础效应：CARM作为一个学习机制的有效性**

在深入分析各参数前，我们首先需要确立CARM作为一个学习机制的有效性。所有仿真均在 $$50×50$$ 的格子上进行，初始合作率 $$ρ_C(t=0)=0.5$$.

**Figure 2 折线图** ：合作率和合作簇边界长度随蒙特卡洛时间步长的变化曲线

**X轴**：仿真的蒙特卡洛时间步长（对数坐标轴）

**Y轴**：系统的合作率（从0到1）

数据来源，三组标准参数组合产生的时序数据，分别是

标准参数组合1 $ r=3.0, \kappa = 1.0, \beta = 1.0,\gamma =1.0$ 下合作率的变化曲线，边界簇长度的变化曲线

标准参数组合2 $ r=5.5, \kappa = 0.5, \beta = 0.5,\gamma =0.3$ 下合作率的变化曲线，边界簇长度的变化曲线

标准参数组合3 $ r=3.7, \kappa = 0.3, \beta = 0.3,\gamma =0.7$下合作率的变化曲线，边界簇长度的变化曲线

这三种参数组合必须展示不同的学习现象，由于时间轴长度一般较长，那么子图按从上到下的顺序进行排列

**子图（a）**：图中一共两条曲线，代表标准参数组合1下，合作率、合作簇长度随时间的变化曲线

**子图（b）**：图中一共两条曲线，代表标准参数组合2下，合作率、合作簇长度随时间的变化曲线

**子图（c）**：图中一共两条曲线，代表标准参数组合3下，合作率、合作簇长度随时间的变化曲线

从 Figure 2 中可以发现，群体的合作水平随时间收敛到稳态，或者呈现出波动震荡形式，而合作簇长度也会随之发生改变，并到达稳态或者震荡，这说明我们的算法的确是有在学习的。

关于合作簇长度 L_CD 的值及其随时间的变化，是解读空间博弈动态的一把利器：

**高 L_CD 值**:

**物理形态**: 策略分布非常“混乱”和“犬牙交错”。这通常对应着大量细小的、不规则的合作者与背叛者集群，彼此深度混合，就像“椒盐噪声”或打碎的玻璃。

**科学含义**: 系统处于**高度混合**或**不稳定**的状态。这常见于：

**初始时刻**: 随机分布的策略必然产生极高的L_CD。

**动态震荡期**: 当合作者和背叛者相互激烈入侵，形成纠缠的“战线”时，L_CD会很高。

**低 L_CD 值**:

**物理形态**: 策略分布非常“平滑”和“有序”。这对应着少数几个大的、形状规整（趋近于圆形或方形）的同策略集群。

**科学含义**: 系统达到了**高度的自组织和分离**状态。这是**空间互惠（Spatial Reciprocity）**机制发挥作用的直接证据。合作者通过“抱团取暖”，形成紧凑的集群，将与背叛者的接触面（即边界）最小化，从而保护了集群内部的合作者，使其能够抵御背叛者的剥削。

**L_CD 随时间的变化**:

**L_CD 持续下降**: 这是**系统自组织能力**的明确信号。即使宏观合作率 ρ_C 已经稳定，L_CD 的下降也表明微观上小的集群正在合并（coarsening）成更大的集群，系统在“退火”并走向一个能量更低、更稳定的空间结构。这是从\**快速的宏观平衡**过渡到**缓慢的微观结构优化**的标志。

**L_CD 持续震荡**: 如果 L_CD 与 ρ_C 同步震荡，这描绘了一幅生动的画面：合作者集群（陆地）周期性地扩张（ρ_C上升），其边界变得平滑（L_CD可能暂时下降），然后被背叛者（海洋）反扑，边界被侵蚀得支离破碎（L_CD上升），合作者地盘缩小（ρ_C下降），周而复始。



**3.2 参数解剖：认知权重** $$β$$ , $$γ$$, $$κ$$ **的独立影响**

接下来，独立分析这三个认知权重对合作率带来的影响

绘制4组图，每组图都展示 $$ρ_C$$ vs $$r$$ 的关系，但在每组图中，我们分别改变 $$β, γ, κ$$ 中的一个，同时固定其他参数。

**Figure 3a 小提琴图**：不同 $\beta$ 取值下， 合作率随增益因子的变化曲线

**X轴**：增益因子 $r$ 的离散取值（从2.2到5.8），每隔0.3的间隔取一个值

**Y轴**：系统的合作率（从0到1）

对应每个离散的$$r$$，绘制出四个提琴图像，每个提琴对应一个 β 值 (分别取值 0.1, 0.5, 1.0, 2.0)，固定其他两个认知参数 

下面使用的默认参数为   "GAMMA": 0.5, "KAPPA": 0.5

我们仿真的数量为10，总部长为100000步，并取最后1000步，其他与默认设置相同

**Figure 3b 小提琴图**：不同 $\gamma$ 取值下， 合作率随增益因子的变化曲线

**X轴**：增益因子 $r$ 的离散取值（从2.2到5.8），每隔0.3的间隔取一个值

**Y轴**：系统的合作率（从0到1）

对应每个离散的 $r$，绘制出四个提琴图像，每个提琴对应一个  $\gamma$  值 (分别取值 0.1, 0.5, 1.0, 2.0)，固定其他两个认知参数 

下面使用的默认参数为   "BETA": 0.5, "KAPPA": 0.5

我们仿真的数量为10，总部长为100000步，并取最后1000步，其他与默认设置相同

**Figure 3c 小提琴图**：不同 $\kappa$ 取值下， 合作率随增益因子的变化曲线

**X轴**：增益因子 $r$ 的离散取值（从2.2到5.8），每隔0.3的间隔取一个值

**Y轴**：系统的合作率（从0到1）

对应每个离散的 $r$，绘制出四个提琴图像，每个提琴对应一个  $\kappa$  值 (分别取值 0.0, 0.3, 0.7, 1.0)，固定其他两个认知参数 

下面使用的默认参数为   "BETA": 0.5, "GAMMA": 0.5

我们仿真的数量为10，总部长为100000步，并取最后1000步，其他与默认设置相同





- 参数交互：合作的相空间分析

绘制其在仿真达到稳态后，合作者比例 $$ρ_C$$ 在两个认知参数作用下产生的二维相图，这里是整项研究最耗时的计算任务，我们需要对每个参数组合，跑出合理次数和合理步长的MC模拟（这里我们设置10个并行的MC模拟环境，每个环境跑10000个热身步之后，再取后500个step的数据，然后我们平均这500个环境产生的数据）。我们需要计算50*50个热力像素，即2500个参数组合的稳态数据。

**Figure 4 二维热力相图** ：增益因子 $r$ 在下面三个相图中都固定为 4.0，研究其余三个参数的两两组合

以下三个图，分开进行绘制，并且我们要考虑震荡的情况，因此我们需要展示一个关于分布的相图，这里我们考虑绘制两张并排的相图

**图 4(a) **：X轴为 β，Y轴为 γ，颜色代表 ρ_C。此图旨在揭示“可及性”和“责任归因”的协同作用

**数据**：我们固定  $$r=3.7,\kappa=0.3$$ , 对  β 和 γ 采取对数均匀取点，从0.1到2.0生成对数均匀的50个点

**左子图 4(a.1) - 均值相图**: 颜色代表合作率分布的**均值 ⟨ρ_C⟩**。这展示了合作的“平均水平”

**右子图 4(a.2) - 幅度相图**: 颜色代表合作率分布 **变异系数 CV = σ/μ**。这展示了合作的“震荡幅度”或“不稳定性”



**图 4(b)**： X轴为 γ，Y轴为 κ，颜色代表 ρ_C。此图旨在探索“责任归因”和“非对称性”的协同作用

**数据**：我们应该固定  $$r=3.7,\beta=0.5$$ ，对 γ 采取对数均匀取点，从0.1到2.0生成对数均匀的50个点，对 $$\kappa$$ 采取线性均匀取点，从0到1，生成50个均匀的点 

**左子图 4(b.1) - 均值相图**: 颜色代表合作率分布的**均值 ⟨ρ_C⟩**。这展示了合作的“平均水平”

**右子图 4(b.2) - 幅度相图**: 颜色代表合作率分布的**标准差 σ(ρ_C)** 或 **变异系数 CV = σ/μ**。颜色代表合作率分布 **变异系数 CV = σ/μ**。这展示了合作的“震荡幅度”或“不稳定性”



**子图 (c)**： X轴为 κ ，Y轴为 β，颜色代表 ρ_C。此图旨在探索“非对称性”和“可及性”的协同作用

**数据**：我们应该固定  $$r=3.7,\gamma=0.5$$ ，对 $$\beta$$ 采取对数均匀取点，从0.1到2.0生成对数均匀的50个点，对 $$\kappa$$ 采取线性均匀取点，从0到1，生成50个均匀的点 

**左子图 4(c.1) - 均值相图**: 颜色代表合作率分布的**均值 ⟨ρ_C⟩**。这展示了合作的“平均水平”

**右子图 4(c.2) - 幅度相图**: 颜色代表合作率分布的**标准差 σ(ρ_C)** 或 **变异系数 CV = σ/μ**。这颜色代表合作率分布 **变异系数 CV = σ/μ**。这展示了合作的“震荡幅度”或“不稳定性”





**3.4 微观动力学：合作簇的形成与演化**

选取三组有代表性的参数组合，记录并展示系统演化的关键时间点的网格快照

**Figure 5 极限环图 (Limit Cycle Plot) / 相空间轨迹图**

**思想**：这是对动力学案例的进行的一个分类，将包含几类典型的动态特征。如果系统在震荡，那么它的状态很可能在一个“极限环”上运动。我们可以尝试在某个二维相空间中画出这个环。选择两个能反映系统状态的、相互关联的宏观变量。最经典的选择是**合作者密度 $$ρ_C$$** 和 **背叛者-合作者边界的密度 $$ρ_{CD}$$** (L_CD / N)

**可视化 (Figure X)**:

**X轴**: $$ρ_C$$

**Y轴**: $$ρ_{CD}$$

**子图(a) - 稳态收敛 (Stable Equilibrium)**: 轨迹最终汇集到一个点，这里可以尝试的参数组合是 $$r=4.0, β=0.5, γ=2.0, κ=0.3$$

**子图(b) - 周期性震荡 (Limit Cycle)**: 轨迹形成一个清晰的闭合环，这里可以尝试的参数组合是  $$r=4.0, β=0.1, γ=1.0, κ=0.3$$

**子图(c) - 混沌或更复杂的行为**: 如果能找到，轨迹会填满一个吸引子区域，这里需要找更精确的参数组合

**内容**: 绘制系统在统计稳态下，状态点 (ρ_C(t), ρ_{CD}(t)) 随时间 t 演化的轨迹。如果系统收敛到稳态，轨迹会汇集到一个点；如果系统是周期性震荡，轨迹会形成一个闭合的环（极限环）；如果是混沌的，轨迹会填满一个奇怪的吸引子区域。

**子图插图：功率谱密度图 (Power Spectrum Density Plot)**

**思想**: 任何时序信号（如 $$ρ_C(t)$$）都可以通过傅里叶变换分解为其包含的各种频率成分。这能精确地告诉我们震荡的**周期**是什么。 可以在每个子图的**右上角**放一个小插图（inset），展示对应时间序列的**功率谱密度图**。稳态收敛的功率谱是平的；极限环的功率谱会有一个**尖锐的峰**；混沌的功率谱则是宽带噪声。

**方法**: 对统计稳态下的 $$ρ_C(t)$$ 时间序列进行快速傅里叶变换（FFT），计算其功率谱。

**X轴**: 频率 f

**Y轴**: 功率谱密度 (Power/Frequency)

**内容**: 如果 ρ_C 是随机波动，图像会是平坦的噪声。如果存在周期性震荡，图像会在某个主导频率 f_0 处出现一个**尖锐的峰**。这个 f_0 的倒数 T = 1/f_0 就是震荡的周期（以MCS为单位）。



**Figure 7 桑基图**：

只分析Fig 5 和Fig 6 中的震荡案例。使用桑基图定量展示微观策略流，对前文的震荡系统的参数组合制作两阶段的桑基图：从t-1时刻到t时刻，合作率从波谷向波峰攀升，从t时刻到t+1时刻从波峰向波谷下跌

**- 上升阶段 (Ascending Phase)**: 在合作率从波谷向波峰运动的时间段内，统计策略转换流量。

- **左侧节点**: "Cooperator (t)", "Defector (t)".
- **右侧节点**: "Cooperator (t+1)", "Defector (t+1)".
- **流 **: 连接节点的带状区域，其宽度代表在稳态下一个MCS内发生相应策略转换的智能体平均比例。包括四条流：C→C (坚守合作), C→D (背叛), D→C (转为合作), D→D (坚守背叛)。

**下降阶段 (Descending Phase)**: 在合作率从波峰向波谷运动的时间段内，统计策略转换流量。

- **左侧节点**: "Cooperator (t)", "Defector (t)".
- **右侧节点**: "Cooperator (t+1)", "Defector (t+1)".
- **流 **: 连接节点的带状区域，其宽度代表在稳态下一个MCS内发生相应策略转换的智能体平均比例。包括四条流：C→C (坚守合作), C→D (背叛), D→C (转为合作), D→D (坚守背叛)。

这里可以用提琴图再次解释为什么会出现这样的流量，我们的研究最终揭示了CARM模型中合作率周期性震荡的深刻微观机理。**Figure 7a**的桑基图定量地证明，震荡是由**策略转换流的周期性反转**所驱动的：在上升阶段，D→C流量占据主导；而在下降阶段，C→D流量则占据主导。**Figure 7c**的提琴图则进一步揭示了这一流量反转背后的**心理动机**：这种反转是由**群体性的累积遗憾压力**在背叛者和合作者两大阵营之间的周期性转移所引发的。这两张图共同构成了一个完整的证据链，证明了系统震荡是一个由内在认知状态（遗憾）驱动微观行为（策略转换），进而涌现出宏观社会动态（合作率波动）的、深刻的**认知-行为反馈循环**。这为理解真实社会系统中合作行为的复杂动态提供了新的理论视角。

**遗憾值的非对称分布**: 两个小提琴图的形状都**不是对称**的。它们的“肚子”和中位数都显著地偏离了0点，并且有长长的“尾巴”伸向高遗憾值区域。

**“心理压力”的系统性转移**:

**上升阶段 (驱动 D→C)**:

**背叛者 (Defector, 红色提琴)**: 其累积遗憾的分布**显著地偏向正值区域**。它的中位数（中间的白线）和大部分“肚子”都**高于0**。这意味着，在合作率上升的阶段，大部分背叛者都在为其“没有选择合作”而感到**强烈的、持续的遗憾**。

**合作者 (Cooperator, 蓝色提琴)**: 其累积遗憾的分布则相对**集中在0附近**，甚至略微偏向负值（庆幸）。这意味着他们对自己的合作选择基本满意。

**下降阶段 (驱动 C→D)**:

**合作者 (Cooperator, 蓝色提琴)**: 情况发生**惊天逆转**！合作者的累积遗憾分布现在**显著地偏向了正值区域**。大部分合作者都在为其“没有选择背叛”而感到**强烈的遗憾**。

**背叛者 (Defector, 红色提琴)**: 他们的遗憾压力则大大减轻，分布更靠近0。



**Figure 6 网格快照**

挑选同步更新中的几个关键点进行快照展示，我们的方案是，固定运行2000步，分别取0，10，100，1998，1999，2000 这6个时间步的快照。

由于在代码中不方便更改了，这里我们图6直接读取的是图5的三个配置文件，而图5和图7的试验我们现在已经完全弃用了。

**子图（a）**参数组合一：稳定低水平合作的场景

  "L": 50, 

  "INIT_COOP_RATIO": 0.5, 

  "COST": 1.0,

  "MAX_MC_STEPS": 2000, 

  "RECORD_INTERVAL_MC": 1,

  "R_FACTOR": 3.7, 

  "BETA": 0.5, 

  "GAMMA": 0.5, 

  "KAPPA": 0.2

方形快照图中每个点代表一个特定智能体，合作者和背叛者用不同颜色区分

第一行，展示参数组合一的合作者和背叛者的策略分布情况的网络快照，一共六个子图

第二行，展示参数组合一对应时间快照下的遗憾热力图。每个格点的颜色代表该智能体在当前时刻计算出的即时非对称归因遗憾 

**子图（b）**参数组合二：轻微震荡的场景

  "L": 50, 

  "INIT_COOP_RATIO": 0.5, 

  "COST": 1.0,

  "MAX_MC_STEPS": 2000, 

  "RECORD_INTERVAL_MC": 1,

  "R_FACTOR": 3.7, 

  "BETA": 0.5, 

  "GAMMA": 0.5, 

  "KAPPA": 1.0

第一行，展示参数组合二的合作者和背叛者的策略分布情况的网络快照，一共六个子图

第二行，展示参数组合二对应时间快照下的遗憾热力图。每个格点的颜色代表该智能体在当前时刻计算出的即时非对称归因遗憾 

**子图（c）**参数组合三：剧烈震荡的场景

  "L": 50, 

  "INIT_COOP_RATIO": 0.5, 

  "COST": 1.0,

  "MAX_MC_STEPS": 5000, 

  "RECORD_INTERVAL_MC": 1,

  "R_FACTOR": 3.7, 

  "BETA": 0.2, 

  "GAMMA": 0.8, 

  "KAPPA": 0.3

第一行，展示参数组合三的合作者和背叛者的策略分布情况的网络快照，一共六个子图

第二行，展示参数组合三对应时间快照下的遗憾热力图。每个格点的颜色代表该智能体在当前时刻计算出的即时非对称归因遗憾 



**实验7：对实验6的深度解读**

现在，我们要重新设计实验7，实验7中的参数与我们实验6保持一致，我们在绘制实验6的网格快照时，设计了三组参数（r=3.7, β=0.5，γ=0.5，κ=1.0），（r=3.7, β=0.5，γ=0.5，κ=0.2）以及（r=3.7, β=0.2，γ=0.8，κ=0.3），这就是我们实验7需要运行的参数组合，我们每组参数并行10次直接取并行的均值

**实验思路：**

1.  **核心测量**: 在仿真过程的**每一步**，我们需要计算并记录两个新的、核心的概率：
    *   **合作者留存率 `P(C→C)(t)`**: 在`t`时刻是合作者的智能体中，有多少比例在`t+1`时刻**仍然**是合作者。这个指标直接量化了**合作策略的“粘性”或“韧性”**。
    *   **背叛者转化率 `P(D→C)(t)`**: 在`t`时刻是背叛者的智能体中，有多少比例在`t+1`时刻**转变**为合作者。这个指标量化了**合作的“吸引力”或“招募能力”**。
2.  **仿真协议**: 分别进行10次独立重复仿真，每次10000步。在每一步，记录这两个概率。
3.  **数据聚合**: 对10次运行的结果求平均，得到这两个概率的时间序列。

我们将设计一张包含两个垂直堆叠的子图的Figure。

**图形设计 (Figure 7):**

*   **整体布局**: 一张图，包含两个**上下排列**的子图，共享X轴。
*   **X轴**: **时间 (Monte Carlo Steps)**，对数尺度。
*   **三条曲线**: 蓝色 （参数组合一），红色 （参数组合二），橙色 （参数组合三）。

**子图 (a): 合作者留存率 `⟨P(C→C)(t)⟩` vs. 时间 `t`**

*   **Y轴**: Cooperator Retention Rate `⟨P(C→C)⟩` (合作韧性)

**子图 (b): 背叛者转化率 `⟨P(D→C)(t)⟩` vs. 时间 `t`**

*   **Y轴**: Defector Conversion Rate `⟨P(D→C)⟩` (合作吸引力)





**实验8：测量“累积后悔驱动力”**

实验8是对我们在图 （r=2.2,β=0.5，γ=0.5，κ=0.0），（r=3.0,β=0.5，γ=0.5，κ=0.0）以及（r=3.8,β=0.5，γ=0.5，κ=0.0）进行了三次实验

宏观合作率`ρ_C`最终能稳定下来，意味着系统达到了一个**动态平衡**。在这个平衡点，从合作阵营流失到背叛阵营的“人口”，应该约等于从背叛阵营流入合作阵营的“人口”。

我们可以用一个数学方程来描述这个平衡：
$$
\text{合作者流失数} \approx \text{背叛者流入数}
$$
用概率和人口基数来表示：
$$
\rho_C \times P(C \to D) \approx (1 - \rho_C) \times P(D \to C)
$$
其中，`P(C→D)`是合作者叛逃的概率，`P(D→C)`是背叛者转化的概率。

我们可以从这个方程解出稳态合作率`ρ_C`的理论预测值：
$$
\rho_C \approx \frac{P(D \to C)}{P(D \to C) + P(C \to D)}
$$
这个公式告诉我们，最终的合作率是由**合作的吸引力 (`P(D→C)`)** 和**合作的风险 (`P(C→D)`)** 共同决定的。

而这两个核心的流动概率，又是由智能体在它们**各自经历的环境中**的累积后悔决定的：
*   `P(C→D) = Σ p(s|C) * ⟨P(C→D|s)⟩_C`
*   `P(D→C) = Σ p(s|D) * ⟨P(D→C|s)⟩_D`

其中，`⟨P(C→D|s)⟩_C`就是智能体在状态`s`下选择背叛的概率，即 `R_D+ / (R_C+ + R_D+)`。

**实验设计：**

1.  **仿真协议**: 运行10次，每次10000步，取最后1000步。
2.  **数据采集**: 在稳态的1000步中，对于每一个智能体，记录：`r`, `run_id`, `agent_action`, `num_coop_neighbors (s)`, `R(s,C)`, `R(s,D)`。
3.  **数据分析与聚合 (核心)**:
    *   对于每个`r`值和每个`run_id`：
        *   **a. 计算实际合作率 `ρ_C_observed`**: 直接计算这1000步中合作者的平均比例。
        *   **b. 计算条件概率 `p(s|C)` 和 `p(s|D)`**。
        *   **c. 计算条件决策概率**:
            *   对于合作者群体，计算在每个`s`下，叛逃的平均概率 `⟨P(C→D|s)⟩_C`。
            *   对于背叛者群体，计算在每个`s`下，转化的平均概率 `⟨P(D→C|s)⟩_D`。
        *   **d. 计算总流动概率**:
            *   `P(C→D) = Σ p(s|C) * ⟨P(C→D|s)⟩_C`
            *   `P(D→C) = Σ p(s|D) * ⟨P(D→C|s)⟩_D`
        *   **e. 计算理论合作率 `ρ_C_predicted`**: 使用我们上面的稳态方程。
    *   **最终聚合**: 对10次运行的`ρ_C_observed`和`ρ_C_predicted`分别求平均值。

**可视化呈现：一个无可辩驳的对比图**

我们将设计一张包含**一个核心子图**的Figure。

*   **X轴**: 协同因子 `r`，取离散值 `2.2, 3.0, 3.8`。
*   **Y轴**: Cooperator Density `ρ_C`。
*   **图中元素**:
    *   **条形图**: 用**条形图**表示我们**实际观察到的平均合作率 `⟨ρ_C_observed⟩`**。条的高度就是合作水平，误差棒可以表示10次运行的标准差。
    *   **散点**: 在每个条形图的顶部，用一个**醒目的散点**（例如，带黑边的星号）来表示我们**理论预测的合作率 `⟨ρ_C_predicted⟩`**。

### **1. 条件决策概率 ⟨P(action'|action, s)⟩ 是如何计算的？**

这个量是**统计**出来的。

**具体计算过程如下：**

1. **收集微观样本**: 在稳态的1000步中，我们收集了大量的“决策快照”。每一个快照包含一个智能体的信息：agent_action, s, regret_C, regret_D。
2. **计算单次决策概率**: 对于**每一个**快照，我们根据其regret_C和regret_D，计算出该智能体在**那一刻**选择合作的概率 prob_C = R_C+ / (R_C+ + R_D+)。
3. **分组求平均**: 然后，我们将所有合作者的快照按s分组，并计算每个s组内prob_D (1 - prob_C)的平均值，这就得到了⟨P(C→D|s)⟩_C。对背叛者做同样操作，得到⟨P(D→C|s)⟩_D。

所以，这个量**是统计值**。它代表了处于特定情境下的一个群体，其**平均**的决策倾向。

### **2. 条件概率 p(s|C) 和 p(s|D) 是如何计算的？**

同样地，这两个量也**是统计**出来的。

**具体计算过程如下：**

1. **筛选群体**: 我们将所有微观样本分成两组：合作者组和背叛者组。
2. **频率统计**:
   - 在合作者组内，我们对num_coop_neighbors (s) 这一列进行值计数（value counts）并归一化，就得到了合作者群体经历各种环境的频率分布 p(s|C)。
   - 对背叛者组做同样操作，得到p(s|D)。

**图形设计复述与确认:**

- **布局**: 三个并排的子图，分别对应 r=2.2, 3.0, 3.8。
- **X轴**: 邻居合作者数量 s (0-4)，离散取值。
- **Y轴**: 概率 (0-1)。
- **每个子图内包含四条曲线**:
  1. **蓝色条形图**: p(s|C) (合作者的环境频率)。
  2. **红色条形图**: p(s|D) (背叛者的环境频率)。
  3. **蓝色折线**: ⟨P(C→D|s)⟩_C (合作者在各环境下的平均叛逃概率)。
  4. **红色折线**: ⟨P(D→C|s)⟩_D (背叛者在各环境下的平均转化概率)。
- **图中的“决定性指标”**: 在每个子图中添加（一个文本框），我们需要展示两个关键的计算值：
  1. **总流动概率**: P(D→C) = Σ p(s|D) * ⟨P(D→C|s)⟩_D 和 P(C→D) = Σ p(s|C) * ⟨P(C→D|s)⟩_C。
  2. **实际观测的总流动比率**: 我们可以在仿真中**直接计数**真实的P(D→C)_observed和P(C→D)_observed。

在文本框中，我们做如下展示：

> **r = 3.0**
>
> **P(C→D): 0.751**
>
> **P (D→C):0.248**
>
> **ρ_C=0.248 / (0.248 + 0.751) = 0.248**

